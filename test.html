
<!DOCTYPE html>
<html>
  <head>
    <title>ClearPath Maps</title>
	<link rel="shortcut icon" href="images/favicon.ico" >
    <link rel="icon" type="image/gif" href="images/animated_favicon1.gif" >
	<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />	
    <link rel="stylesheet" href="jquery/development-bundle/themes/base/jquery.ui.all.css">
	<!-- <script type="text/javascript" src="jquery.js"></script> -->
	<script src="jquery/js/jquery-1.7.1.min.js"></script>
	<script src="jquery/development-bundle/ui/jquery.ui.core.js"></script>
	<script src="jquery/development-bundle/ui/jquery.ui.widget.js"></script>
	<script src="jquery/development-bundle/ui/jquery.ui.mouse.js"></script>
	<script src="jquery/development-bundle/ui/jquery.ui.slider.js"></script>
	<link rel="stylesheet" href="jquery/development-bundle/demos/demos.css">
    <link href="../static/stylesheets/bootstrap-toggle-buttons.css"
          rel="stylesheet">
	<style>
	#demo-frame > div.demo { padding: 10px !important; };
	</style>
	
	<style type="text/css">
	.getpath {
		-moz-box-shadow:inset 0px 1px 0px 0px #97c4fe;
		-webkit-box-shadow:inset 0px 1px 0px 0px #97c4fe;
		box-shadow:inset 0px 1px 0px 0px #97c4fe;
		background-color:#4c8799;
		border:2px solid #c4d8f5;
		display:inline-block;
		color:#d6fbff;
		font-family:arial;
		font-size:15px;
		font-weight:bold;
		padding:6px 21px;
		text-decoration:none;
		text-shadow:1px 1px 0px #0000ed;
	}.getpath:hover {
		background-color:#257a94;
	}.getpath:active {
		position:relative;
		top:1px;
	}
	#btn{
		padding:6px 90px;	
	}
	/* This imageless css button was generated by CSSButtonGenerator.com */
	</style>
	
    <style type="text/css">
	  .sl { width:280px; }
      html { height: 100% }
      body { height: 100%; margin: 0; padding: 0 }
      #map_canvas { height: 100% }
    </style>
	
    <style>
      body {
        font-family: sans-serif;
        font-size: 14px;
      }
      #map_canvas {
        height: 400px;
        width: 600px;
        margin-top: 0.6em;
      }
      input {
        border: 1px solid  rgba(0, 0, 0, 0.5);
		height: 20px;
      }
      input.notfound {
        border: 2px solid  rgba(255, 0, 0, 0.4);
      }
    </style>

	<script>
	$(function() {
		$( "#slider" ).slider({
			value:0,
			min: 360,
			max: 1200,
			step: 15,
			slide: function( event, ui ) {
			var hours = Math.floor(ui.value / 60);
            var minutes = ui.value - (hours * 60);

            if(hours<10) 
			hours = '0' + hours;
            if(minutes== 0) 
			minutes = '00';
			
			$( "#time_select" ).val( hours+':'+minutes );
			}
		});
		$( "#time_select" ).val( "06:00" );
	});
	</script>
	<script type="text/javascript"
		src="http://maps.googleapis.com/maps/api/js?key=AIzaSyBOiIXn23pwlpvSxWFN6kS64m5Oo8YsquU&sensor=true&libraries=places">
	</script>
    <script type="text/javascript">
    var directionsDisplay;
    var directionsService = new google.maps.DirectionsService();
	var los_angeles = new google.maps.LatLng(34,-118.3);
	var map;
	var markers = new Array();
	var count=0;
	var req;
	var output;
	var lati= new Array();
	var longi= new Array();
	var turn;
	var nodesinfo;
	var poly;
	var toLatLng; var fromLocationLL; var toLocationLL;
	
	var polyOptions = {
		    strokeColor: '#31B404',
		    strokeOpacity: 1.0,
		    strokeWeight: 4
		  }
		  
	function getturnInfo(){
       ////alert("123");
	   //document.getElementById('map_canvas').style.display = "none";
	   //document.getElementById('btn2').style.display = "none";
	   //document.getElementById('newSearch').style.display = "none";	   
	   //document.getElementById('btn').style.visibility = "hidden";
	   document.getElementById('slider').style.visibility="hidden";
	   
	   checkDepartNowRadio();
	   checkArriveByRadio();
	   
	   	if(document.getElementById('content').style.visibility == "visible"){
			document.getElementById('content').style.visibility = "hidden";
		}
		else{
			document.getElementById('content').style.visibility = "visible";
		}
	 
	 
	 // var a = "c<br>";
	  //a = a+"b";
	  var nodes = turn.split(",");
	  var count_t = 0;
	  var out="";
	  var row = 0;
	  var totalDistance = 0;
	  var accidents = 0;
	  var directionData='<hr><table>';
	  for(var i=0;i<nodes.length;i+=5){
	        //if(count_t == 0)
			out += "<font size=3>"+ ++row +"</font>. ";
			
	        //count_t++;
			out += "<font size=3>"+nodes[i]+" "+nodes[i+1]+" "+nodes[i+2]+" "+nodes[i+3]+" "+nodes[i+4]+"</font></br>";
			//if((count_t>=0&&count_t<=4))
			//out = out +"<font size=3>,</font> ";
			//if(count_t == 5){
			// out = out + "<br>";
			//  count_t = 0;
			//}
			var direction = nodes[i];
			directionData += '<tr>';
			if(direction == 'F' || direction == 'N')
				directionData += '<td><img src="images/directions/straight.png"></td>';                
			else if(direction == 'W' || direction == 'L')
				directionData += '<td><img src="images/directions/left_turn.png"></td>';                
			else if(direction == 'E' || direction == 'R')
				directionData += '<td><img src="images/directions/right_turn.png"></td>';                			
			else if(direction == 'SL')
				directionData += '<td><img src="images/directions/sleft_turn.png"></td>';                			
			else if(direction == 'SR')
				directionData += '<td><img src="images/directions/sright_turn.png"></td>';                			
			else if(direction == 'M')
				directionData += '<td><img src="images/directions/merge.png"></td>';                			
			else if(direction == 'M-VLR')
				directionData += '<td><img src="images/directions/left_ramp.png"></td>';                			
			else if(direction == 'EXIT')
				directionData += '<td><img src="images/directions/exit.png"></td>';                			
			else
				directionData += '<td><img src="images/directions/straight.png"></td>';      
			
			var miles = nodes[i+4].split(';')[0];
			accidents = nodes[i+4].split(';')[1];
			//accidents = accidents.match(/\d+/);
			accidents = /(\d+)/.exec(accidents);
			directionData += '<td>'+nodes[i+1]+'</td><td align="right">'+miles+'</td>';
			directionData += '</tr>';		
			totalDistance += parseInt(miles);
		}
		directionData += '</table>';
		document.getElementById('totalDistance').innerHTML =  '<font size=4>Distance: '+ totalDistance +' miles</font>';	
		document.getElementById('accidents').innerHTML =  '<font size=4>Accidents: ' +accidents[1]+ '</font>';
		
		//alert(directionData);
	//document.getElementById('content').innerHTML=(nodesinfo+"<br>"+out);
	  document.getElementById('content').innerHTML=directionData;
	  document.getElementById('turninfo').style.display = "block";	 
	}	
	
	/*++ swapnil.c: getting lat long from given locations and apply markers to map ++*/
	function getLatLongFromAddress() 
	{
		var fromLocation = document.getElementById('from').value;
		var toLocation = document.getElementById('to').value;		
		
		//alert(fromLocation);
		if(fromLocation!='Enter a location' && toLocation!='Enter a location' && fromLocation!='' && toLocation!=''){
			//alert('success');
			var geocoder = new google.maps.Geocoder();
			geocoder.geocode( { 'address' : fromLocation }, function( results, status ) {
				if ( status == google.maps.GeocoderStatus.OK ) {
					var fromLL = document.getElementById('fromLatLng'); // fromLatLng is my hidden field, use your own
					var fLL = results[0].geometry.location.lat() + ',' + results[0].geometry.location.lng();
					fromLL.innerHTML = results[0].geometry.location.lat() + ',' + results[0].geometry.location.lng();
					////alert(fromLL.innerHTML);
					////alert(fLL);
					fromLocationLL = new google.maps.LatLng(results[0].geometry.location.lat(), results[0].geometry.location.lng());
				} else {
					//alert( "Geocode was not successful for the following reason: " + status );
				}

			}); 
			geocoder.geocode( { 'address' : toLocation }, function( results, status ) {
				if ( status == google.maps.GeocoderStatus.OK ) {
					var toLL = document.getElementById('toLatLng'); // fromLatLng is my hidden field, use your own
					toLL.innerHTML = results[0].geometry.location.lat() + ',' + results[0].geometry.location.lng();
					////alert(toLL.innerHTML);
					toLocationLL = new google.maps.LatLng(results[0].geometry.location.lat(), results[0].geometry.location.lng());
				} else {
					//alert( "Geocode was not successful for the following reason: " + status );
				}

			}); 
			var mb = $('#fromLatLng').text();		
			var mb1 = $('#toLatLng').text();
			if(mb!='fromLL' && mb1!='toLL'){
				//alert(fromLocationLL);
				markers[0] = new google.maps.Marker({
				position: fromLocationLL,
				map: map
				});
				markers[1] = new google.maps.Marker({
				position: toLocationLL,
				map: map
				});
				document.getElementById('slider').disabled=false;
				checkDepartNowRadio();				
				checkArriveByRadio();
			}
		}
		getPath();	
	}
	/*-- swapnil.c: getting lat long from given locations and apply markers to map --*/  
	
	function getPath(){
		////alert("Get Path Called");
		directionsDisplay.setMap(null);
		directionsDisplay = new google.maps.DirectionsRenderer();
		directionsDisplay.setMap(map);
		//poly.getPath().clear();
		////alert("Get Path Called test");	
		
		var mb = $('#fromLatLng').text();		
		var mb1 = $('#toLatLng').text();

		
		poly = new google.maps.Polyline(polyOptions);
		poly.setMap(map);
		document.getElementById('tt').style.visibility="hidden";
		document.getElementById('tt2').style.visibility="hidden";
		lati= new Array();
		longi= new Array();
		var time = document.getElementById('time_select').value;
		var hrs = parseInt(time.substring(0,2),10);
		var mins = parseInt(time.substring(3,5),10);
		
		var index = ((hrs-6)*4)+(mins/15);
		////alert(time+" "+hrs+" "+mins+" "+index);		
		var day = document.getElementById('day').value;
		
		var fromLocation = document.getElementById('from').value;
		var toLocation = document.getElementById('to').value;	
		
		if(fromLocation!='' && toLocation!='' && fromLocation!='Enter a location' && toLocation!='Enter a location'){
			//alert('inside2');
			////alert(lat1+","+long1+":"+lat2+","+long2);
			//var url="http://localhost:8080/TDSP_Servlet/TDSPQueryListNewFibo1234?start="+lat1+","+long1+"&end="+lat2+","+long2+"&time="+index+"&update=False&day="+day;
			//var url="http://geodb.usc.edu:8080/TDSP_Servlet/TDSPQueryListNewFibo1234?start="+lat1+","+long1+"&end="+lat2+","+long2+"&time="+index+"&update=False&day="+day;
					//var url="http://128.125.163.86/TDSP_Servlet/TDSPQuerySuper6?start="+lat1+","+long1+"&end="+lat2+","+long2+"&time="+index+"&update=False2&day="+day;	
			if(mb!='fromLL' && mb1 != 'toLL'){		
					//alert(mb+":"+mb1+":"+index+":"+day);
				var departNow = document.getElementById('depart_now').checked; 
				if(departNow==true)	{
					var url="http://128.125.163.86/TDSP_Servlet/TDSPQuerySuper6?start="+mb+"&end="+mb1+"&time="+index+"&update=False1&day="+day;				
					getPathNodes(url);
				} else{
					var url="http://128.125.163.86/TDSP_Servlet/TDSPQuerySuper6?start="+mb+"&end="+mb1+"&time="+index+"&update=False2&day="+day;	
					getPathNodes(url);					
				}
			}
			else{
				//alert('fromLL error');
			}
		}		
		else{
			//alert('inside');
			var lat1= markers[0].getPosition().lat();
			//alert(lat1);
			var long1= markers[0].getPosition().lng();
			var lat2= markers[1].getPosition().lat();
			var long2= markers[1].getPosition().lng();	
				var departNow = document.getElementById('depart_now').checked; 
				if(departNow==true)	{
					var url="http://128.125.163.86/TDSP_Servlet/TDSPQuerySuper6?start="+lat1+","+long1+"&end="+lat2+","+long2+"&time="+index+"&update=False1&day="+day;	
					getPathNodes(url);
				} else{
					var url="http://128.125.163.86/TDSP_Servlet/TDSPQuerySuper6?start="+lat1+","+long1+"&end="+lat2+","+long2+"&time="+index+"&update=False2&day="+day;						
					getPathNodes(url);					
				}			
		}
	}
	
	function getPathNodes(url) { 
		////alert("Get Path Nodes Called");
		//document.getElementById('btn').style.visibility="hidden";
		document.getElementById('slider').style.visibility="hidden";
		document.getElementById('loading').style.visibility="visible";
		checkDepartNowRadio();				
		checkArriveByRadio();
		
		req = new XMLHttpRequest();  
		req.open("GET",url,true);
		req.onreadystatechange = pushPath;
		req.setRequestHeader("Connection", "Close");
		req.setRequestHeader("Method", "GET" + url + "HTTP/1.1");
		req.send(null);
	} 

	function pushPath(){
		////alert("Push Path Called");
		//var output=document.getElementById('nodes');
				
		 if (req.readyState == 4) {
		 
		 try{
		    output = req.responseText;
			//output.innerHTML = req.responseText;				
			}
		 catch (exception){
			output.innerHTML = exception;
			}
		 processOutput();
		}
		 document.getElementById('btn').style.visibility="visible";
		 document.getElementById('loading').style.visibility="hidden";
		 document.getElementById('slider').style.visibility="visible";
		 checkDepartNowRadio();				
		 checkArriveByRadio();
	}
	
	function processOutput(){
		////alert("Process Output Called");
		var nodes = output.split("@")[0].split(";");
		nodesinfo = output.split("@")[0];
		turn = output.split("@")[1];
		////alert(nodes.length);
		for(var i=0;i<nodes.length-1;i++){
			lati[i] = nodes[i].split(",")[0];
			longi[i] = nodes[i].split(",")[1];
		}
		tt = nodes[nodes.length-1].split("-")[0];
		drawPoints();
		////alert(Math.floor(parseFloat(tt)));
		if(tt != '}'){
			document.getElementById('tt').innerHTML=("<font size=4>ClearPath: "+Math.floor(parseFloat(tt))+" minutes</font>");
			document.getElementById('tt').style.visibility="visible";
			//document.getElementById('btn').style.visibility = "hidden";	
			document.getElementById('newSearch').style.visibility = "visible";
			document.getElementById('btn2').style.visibility = "visible";	
		}
		getturnInfo();
	}
	
	
	function drawPoints(){
		////alert("Draw Points Called");		
		var path = poly.getPath();
		for(var i=0;i<lati.length;i++){
			path.push(new google.maps.LatLng(lati[i],longi[i]));
		}
		markers[0].setPosition(new google.maps.LatLng(lati[0],longi[0]));
		markers[1].setPosition(new google.maps.LatLng(lati[lati.length-1],longi[lati.length-1]));
		calcRoute();
	}
	
	
	function HomeControl(controlDiv, map) {
	  controlDiv.style.padding = '5px';

	  // Set CSS for the control border.
	  var controlUI = document.createElement('DIV');
	  controlUI.style.backgroundColor = 'white';
	  controlUI.style.borderStyle = 'solid';
	  controlUI.style.borderWidth = '2px';
	  controlUI.style.cursor = 'pointer';
	  controlUI.style.textAlign = 'center';
	  controlUI.title = 'Click to reset the map';
	  controlDiv.appendChild(controlUI);

	  // Set CSS for the control interior.
	  var controlText = document.createElement('DIV');
	  controlText.style.fontFamily = 'Arial,sans-serif';
	  controlText.style.fontSize = '12px';
	  controlText.style.paddingLeft = '4px';
	  controlText.style.paddingRight = '4px';
	  controlText.innerHTML = 'Reset';
	  controlUI.appendChild(controlText);
	  google.maps.event.addDomListener(controlUI, 'click', function() {
		map.setCenter(los_angeles);
		map.setZoom(10);
		directionsDisplay.setMap(null);
		directionsDisplay = new google.maps.DirectionsRenderer();
		directionsDisplay.setMap(map);
		poly.getPath().clear();
		poly = new google.maps.Polyline(polyOptions);
		poly.setMap(map);
		clearOverlays();
		document.getElementById('slider').disabled=true;
		checkDepartNowRadio();				
		checkArriveByRadio();
		markers = new Array();
		lati= new Array();
		longi= new Array();
		count=0;
		document.getElementById('tt').style.visibility="hidden";
		document.getElementById('tt2').style.visibility="hidden";
		document.getElementById('newSearch').style.visibility = "hidden";
		document.getElementById('btn2').style.visibility = "hidden";
	  });
	}
	
	function clearOverlays() {
      for (var i=0;i<count;i++) {
		markers[i].setMap(null);
	  }
	}
      
    function calcRoute() {
    	  var start = markers[0].getPosition();
    	  var end = markers[1].getPosition();
    	  var request = {
    	    origin:start,
    	    destination:end,
    	    travelMode: google.maps.TravelMode.DRIVING
    	  };
    	  directionsService.route(request, function(result, status) {
    	    if (status == google.maps.DirectionsStatus.OK) {
    	      directionsDisplay.setDirections(result);
    	      var time = result.routes[0].legs[0].duration.value/60;
    	      document.getElementById('tt2').innerHTML = "<font size=4>Google: "+ Math.floor(time) + " minutes</font>";
    		  document.getElementById('tt2').style.visibility="visible";
    			
    	    }
    	  });
    }
      
	function addLatLng(event) {	
		var fromLocation = document.getElementById('from').value;
		var toLocation = document.getElementById('to').value;		
		
		//alert(fromLocation);
		if(!(fromLocation!='Enter a location' && toLocation!='Enter a location' && fromLocation!='' && toLocation!='')){	
			if(count<2)
			{
				markers[count++] = new google.maps.Marker({
				position: event.latLng,
				map: map
				});
				if(count==1){
					document.getElementById('from').style.visibility="hidden";
					document.getElementById('fromLatLng').innerHTML = event.latLng;
					document.getElementById('fromLatLng').style.visibility = "visible";
				}
					
			}
			if(count==2)
			{
				document.getElementById('to').value=event.latLng;
				document.getElementById('slider').disabled=false;
				checkDepartNowRadio();				
				checkArriveByRadio();
						 
				document.getElementById('to').style.visibility = "hidden";
				document.getElementById('toLatLng').innerHTML = event.latLng;
				document.getElementById('toLatLng').style.visibility = "visible";			
			}
		}
	}
	  
	  function dataChanged(){
		//alert(event.keyCode);	
		if(event.keyCode==13){
			//alert(event.keyCode);
			getLatLongFromAddress();
		}		
		markers[0].setMap(null);
		markers[1].setMap(null);
		poly.getPath().clear();
		clearOverlays();
		document.getElementById('btn').style.visibility = "visible";
		document.getElementById('fromLatLng').innerHTML='';
		document.getElementById('toLatLng').innerHTML='';
		document.getElementById('content').innerHTML='';
		document.getElementById('tt').innerHTML='';
		document.getElementById('tt2').innerHTML='';
		document.getElementById('totalDistance').innerHTML='';
		document.getElementById('accidents').innerHTML='';
	  }
	
	  function getTodaysDay(){
		var d = new Date();
		var n = d.getDay();
		var element = document.getElementById('day');
		switch(n){
			case 1: element.value = 'Monday'; break;
			case 2: element.value = 'Tuesday'; break;
			case 3: element.value = 'Wednesday'; break;
			case 4: element.value = 'Thursday'; break;
			case 5: element.value = 'Friday'; break;
			case 6: element.value = 'Saturday'; break;
			default: element.value = 'Monday'; break;
		}
	  }	
	
	  function checkDepartNowRadio(){
		var departNow = document.getElementById('depart_now').checked; 
		if(departNow==true)
		{
			//alert('radio button checked');
			//document.getElementById('slider').style.visibility="hidden";
			//document.getElementById('time_select').style.visibility = "hidden";
			/*var d = new Date();
			var hrs = d.getHours();
			var mins = d.getMinutes();
			//var index = ((hrs-6)*4)+(mins/15);
			if(hrs>=6 && hrs<=20){
				if(mins >= 0 && mins<15) 
					mins = '15';
				else if(mins>=15 && mins<30)
					mins = '30';
				else if(mins>=30 && mins<45)
					mins = '45';			
				else if(mins>=45 && mins<60){
					mins = '00';			
					hrs = hrs+1;
				}					
				if(hrs<10) 
					hrs = '0' + hrs;
				document.getElementById('time_select').value=hrs+":"+mins;
			}
			else*/{
				document.getElementById('time_select').value="06:00";
			}
		}
		else
		{
		  checkArriveByRadio();
		}	  
	  }

	  function checkArriveByRadio(){
		var arriveBy = document.getElementById('arrive_by').checked; 
		if(arriveBy==true)
		{
			//alert('radio button checked');
			document.getElementById('time_select').value="06:00";
			document.getElementById('slider').style.visibility="visible";
			document.getElementById('time_select').style.visibility = "visible";
		}
		else{
				checkDepartNowRadio();
		}
	  }	
	  
	  function reset(){
		dataChanged();  
		initialize();
	  }
	
      function initialize() {
	     directionsDisplay = new google.maps.DirectionsRenderer();
		 document.getElementById('turninfo').style.display = "none";
		 document.getElementById('loading').style.visibility="hidden";
		 document.getElementById('tt').style.visibility="hidden";
		 document.getElementById('tt2').style.visibility="hidden";
		 document.getElementById('btn').style.visibility = "visible";
		 document.getElementById('btn2').style.visibility = "hidden";
		 document.getElementById('newSearch').style.visibility = "hidden";
		 //document.getElementById('time_select').style.display = "none";
		 document.getElementById('fromLatLng').style.visibility = "hidden";
		 document.getElementById('toLatLng').style.visibility = "hidden";
		 document.getElementById('from').style.visibility = "visible";
		 document.getElementById('to').style.visibility = "visible";
		 document.getElementById('from').value = "";
		 document.getElementById('to').value = "";	
		 document.getElementById('totalDistance').innerHTML = "";
		 document.getElementById('accidents').innerHTML = "";
		 document.getElementById('fromLatLng').innerHTML = "";
		 document.getElementById('toLatLng').innerHTML = "";
		 
		 count = 0;
		 checkDepartNowRadio();
		 getTodaysDay();
		 
        var mapOptions = {
		  center: new google.maps.LatLng(34.03033656769632, -118.23760986328125),
          zoom: 11,
          mapTypeId: google.maps.MapTypeId.ROADMAP		  
        };
        map = new google.maps.Map(document.getElementById('map_canvas'),
          mapOptions);
		  
		directionsDisplay.setMap(map);
		google.maps.event.addListener(map, 'click', addLatLng);
		//google.maps.event.addListener(map, 'click', function (event) { 
        ////alert('Hello World!'); });		  

        var inputFrom = document.getElementById('from');
		var inputTo = document.getElementById('to');
        var autocompleteFrom = new google.maps.places.Autocomplete(inputFrom);
		var autocompleteTo = new google.maps.places.Autocomplete(inputTo);

        autocomplete.bindTo('bounds', map);

        var infowindow = new google.maps.InfoWindow();
        var marker = new google.maps.Marker({
          map: map
        });

		var homeControlDiv = document.createElement('DIV');
		var homeControl = new HomeControl(homeControlDiv, map);
		homeControlDiv.index = 1;
		map.controls[google.maps.ControlPosition.TOP_RIGHT].push(homeControlDiv);
		poly = new google.maps.Polyline(polyOptions);
		poly.setMap(map);
		
        google.maps.event.addListener(autocompleteFrom, 'place_changed', function() {
          infowindow.close();
          marker.setVisible(false);
          input.className = '';
          var place = autocomplete.getPlace();
          if (!place.geometry) {
            // Inform the user that the place was not found and return.
            input.className = 'notfound';
            return;
          }

          // If the place has a geometry, then present it on a map.
          if (place.geometry.viewport) {
            map.fitBounds(place.geometry.viewport);
          } else {
            map.setCenter(place.geometry.location);
            map.setZoom(17);  // Why 17? Because it looks good.
          }
          var image = new google.maps.MarkerImage(
              place.icon,
              new google.maps.Size(71, 71),
              new google.maps.Point(0, 0),
              new google.maps.Point(17, 34),
              new google.maps.Size(35, 35));
          marker.setIcon(image);
          marker.setPosition(place.geometry.location);

          var address = '';
          if (place.address_components) {
            address = [
              (place.address_components[0] && place.address_components[0].short_name || ''),
              (place.address_components[1] && place.address_components[1].short_name || ''),
              (place.address_components[2] && place.address_components[2].short_name || '')
            ].join(' ');
          }

          infowindow.setContent('<div><strong>' + place.name + '</strong><br>' + address);
          infowindow.open(map, marker);
        });
		
		google.maps.event.addListener(autocompleteTo, 'place_changed', function() {
          infowindow.close();
          marker.setVisible(false);
          input.className = '';
          var place = autocomplete.getPlace();
          if (!place.geometry) {
            // Inform the user that the place was not found and return.
            input.className = 'notfound';
            return;
          }

          // If the place has a geometry, then present it on a map.
          if (place.geometry.viewport) {
            map.fitBounds(place.geometry.viewport);
          } else {
            map.setCenter(place.geometry.location);
            map.setZoom(17);  // Why 17? Because it looks good.
          }
          var image = new google.maps.MarkerImage(
              place.icon,
              new google.maps.Size(71, 71),
              new google.maps.Point(0, 0),
              new google.maps.Point(17, 34),
              new google.maps.Size(35, 35));
          marker.setIcon(image);
          marker.setPosition(place.geometry.location);

          var address = '';
          if (place.address_components) {
            address = [
              (place.address_components[0] && place.address_components[0].short_name || ''),
              (place.address_components[1] && place.address_components[1].short_name || ''),
              (place.address_components[2] && place.address_components[2].short_name || '')
            ].join(' ');
          }

          infowindow.setContent('<div><strong>' + place.name + '</strong><br>' + address);
          infowindow.open(map, marker);
        });
		google.maps.event.addDomListener(window, 'load', initialize);
      }
    </script>
  </head>
  <body onLoad="initialize()">
      <!-- <input id="searchTextField" type="text" size="50"> -->
	<table>
	  <tr>
		<td colspan="2"><div id="upperbar"><a href="test.html"><img src="images/logo_clearpath.jpg" style="background-color:#b0c4de;"></a></div></td>
	  </tr>	 	
	  <tr>
        <td align="top">	  
		<div id="sidebar" style="margin-left:10px; top:50px; height:650px; max-height:650px; width:315px; max-width:315px; overflow:auto; overflow-y:scroll; overflow-x: hidden;">
		<table width="300px">
			<tr>
			  <td><img src="images/addrA.png"></td>  
				<td><input type="text" id="from" value="" size="35" onKeyPress="dataChanged()" /></td>
			</tr>
			<tr>
			  <td><img src="images/addrB.png"></td>   
				<td><input type="text" id="to" value="" size="35" onKeyPress="dataChanged()"/></td>
			</tr>
		</table>		
		<table width="300px">
				<tr>
					<td><img src="images/time_select.png"></td>
					<td><input type="radio" name="time_radio" id="depart_now" value="depart_now" onclick="checkDepartNowRadio()" checked>Depart At</td>
					<td><input type="radio" name="time_radio" id="arrive_by" value="arrive_by" onclick="checkArriveByRadio()">Arrive By</td>
					<td width="10px"><input type="text" id="time_select" size="5px" style="border:0; font-weight:bold;"></td>
				</tr>
		</table>
		<table width="300px">
			<tr><td>
				<div id="slider" class="sl"></div>
			</td></tr>
		</table>
		<table width="300px">
			<tr>
				<td><label>Day of Departure:</label></td>
				<td><select id="day" onchange="dataChanged()">
					<option>Monday</option>
					<option>Tuesday</option>
					<option>Wednesday</option>
					<option>Thursday</option>
					<option>Friday</option>
					<option>Saturday</option>
					<option>Sunday</option>
					<option>All</option>
				</select></td>
			</tr>
		</table>

		<table width="300px">
			<tr><td><img src="images/travel_mode.png"></td>
				<td>	
					<div id="text-toggle-button">
						<input type="checkbox">
					</div>					
				</td>
			<!--<td>Travel Mode: <select id="mode">
				<option value="DRIVING">Driving</option>
				<option value="WALKING">Walking </option>
				<option value="BICYCLING">Bicycling  </option>
			</select></td>-->
			</tr>
		</table>

		<table width="300px">		
			<tr>
				<td><a href="javascript:getLatLongFromAddress()" id="btn" class="getpath">Get Directions</a></td>
				<!--<input type="button" id="btn" value="Get Path" onClick="getLatLongFromAddress()"/> -->
			</tr>
			<tr>
				<!-- <td><a href="javascript:reset()" id="newSearch" class="getpath">New Search</a> -->
				<td><a href="javascript:reset()" id="newSearch"></a>
				<a href="javascript:getturnInfo()" id="btn2">TurnByTurn</a></td>
			</tr>
			<!-- <input type="button" id="btn2" value="Directions" onClick="getturnInfo()"/></td></tr> -->
		</table>
		
		<div id="tt" style="position:fixed; top:15px; left:370px; color:rgb(214,251,255);"></div>
		<div id="tt2" style="position:fixed; top:15px; left:600px; color:rgb(214,251,255);"></div>
		<div id="totalDistance" style="position:fixed; top:15px; left:810px; color:rgb(214,251,255);"></div>
		<div id="accidents" style="position:fixed; top:15px; left:1000px; color:rgb(214,251,255);"></div>
		<div id="fromLatLng" style="position:fixed; top:65px; left:45px; font-size:12px;">fromLL</div>
		<div id="toLatLng" style="position:fixed; top:100px; left:45px; font-size:12px;">toLL</div>
		
		<table width="300px">			
			<tr><td><div id="turninfo"><p id ="content">asdasd</p></div></td></tr>    
			<tr><td><p id="loading" align="left">Loading Route Please Wait</p></td></tr>
		</table>
      </div></td>
      <td>
		<div id="map_canvas" style="width:100%; height:100%; position:absolute; left:320px; top:40px; border-style:groove;"></div>
	  </td>	
	</tr>
	</table>
	
	<!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>-->
	<script src="../static/js/jquery.toggle.buttons.js"></script>
	<script>
		$('#text-toggle-button').toggleButtons({
			width: 220,
			label: {
				enabled: "Carpool",
				disabled: "No Carpool"
			}
		});
	</script>
	
  </body>
</html>
